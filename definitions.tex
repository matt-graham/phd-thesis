\DeclareMathOperator{\expectation}{\vvmathbb{E}}
\DeclareMathOperator{\indicator}{\vvmathbb{1}}
\DeclareMathOperator*{\argmin}{arg\,min}
\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator{\chol}{chol}
\DeclareMathOperator{\gvn}{|}
\DeclareMathOperator{\Tr}{Tr}
\DeclareMathOperator{\trace}{Trace}
\DeclareMathOperator{\dimension}{dim}
\DeclareMathOperator{\diag}{diag}
\DeclareMathOperator{\sech}{sech}
\DeclareMathOperator{\cosech}{cosech}
\DeclareMathOperator{\support}{supp}

\let\originalleft\left
\let\originalright\right
\renewcommand{\left}{\mathopen{}\mathclose\bgroup\originalleft}
\renewcommand{\right}{\aftergroup\egroup\originalright}

\newcommand{\jacobproddet}[2]{J_{#1}\lpa #2 \rpa}
\newcommand{\probdens}{\mathsf{p}}
\newcommand{\probability}{\mathsf{P}}
%\newcommand{\probdens}{\vvmathbb{p}}
%\newcommand{\probability}{\vvmathbb{P}}
\newcommand{\pden}[1]{\probdens_{#1}}  
\newcommand{\prob}[1]{\probability_{#1}}   
\newcommand{\kldiv}[3][]{\vvmathbb{D}_{\scriptscriptstyle\mathrm{KL}}^{#1}\lsb #2 \,\Vert\, #3 \rsb}
\newcommand{\rdiv}[4][]{\vvmathbb{D}_{#2}^{#1}\lsb #3 \,\Vert\, #4 \rsb}
\newcommand{\varobj}{\vvmathbb{L}}

\newcommand{\grad}[2]{\nabla #1\lpa #2 \rpa}
\newcommand{\preimage}[2]{#1^{-1}[#2]}
\newcommand{\genfunc}{\vctfunc{g}}
\newcommand{\jacobian}[1]{\mathbf{J}_{#1}}
\newcommand{\jacob}[2]{\mathbf{J}_{#1}\kern-1pt\lpa #2 \rpa}

\newcommand{\lebesgue}{\lambda}
\newcommand{\hausdorff}{\mathcal{H}}
\newcommand{\lebm}[1]{
  \ifthenelse { \equal {#1} {1} }
    { \lebesgue }   % if #1 == blank
    { \lebesgue^{\scriptscriptstyle #1} }   % else (not blank)
}
\newcommand{\haum}[1]{
  \ifthenelse { \equal {#1} {} }
    { \hausdorff }   % if #1 == blank
    { \hausdorff^{\scriptscriptstyle #1} }   % else (not blank)
}
\newcommand{\countm}{\#}

\newcommand{\borel}{\mathscr{B}}
\newcommand{\powerset}{\mathscr{P}}

\newcommand{\vct}[1]{\boldsymbol{#1}}
\newcommand{\mtx}[1]{\boldsymbol{#1}}
\newcommand{\idmtx}{\mathbf{I}}
%\newcommand{\set}[1]{\mathcal{#1}}
%\newcommand{\sset}[1]{\mathscr{#1}}
\newcommand{\set}[1]{\mathit{#1}}
\newcommand{\sset}[1]{\mathcal{#1}}
\newcommand{\fset}[1]{\lbr #1 \rbr}
\newcommand{\reals}{\mathbb{R}}
\newcommand{\naturals}{\mathbb{N}}
\newcommand{\integers}{\mathbb{Z}}
\newcommand{\ind}[1]{\indicator_{#1}}
\newcommand{\bigo}[1]{\mathcal{O}\lpa #1\rpa}
\newcommand{\lpa}{\left(}
\newcommand{\rpa}{\right)}
\newcommand{\lbr}{\left\lbrace}
\newcommand{\rbr}{\right\rbrace}
\newcommand{\lsb}{\left[}
\newcommand{\rsb}{\right]}

%\newcommand{\prob}[1]{\vvmathbb{P}\lpa #1 \rpa}
%\newcommand{\prob}[2]{\probability_{#1}\lpa #2 \rpa}
%\newcommand{\probnoarg}[1]{\probability_{#1}}
%\newcommand{\pden}[1]{\vvmathbb{p}\lpa #1 \rpa}
%\newcommand{\pden}[2]{\probdens_{#1}\lpa #2 \rpa}
%\newcommand{\pdennoarg}[1]{\probdens_{#1}}
%\newcommand{\rvar}[1]{%
%  \mathchoice
%  {\mbox{$\mathit{\expandafter\MakeUppercase\expandafter{#1}}$}}
%  {\mbox{\small$\mathit{\expandafter\MakeUppercase\expandafter{#1}}$}}
%  {\mbox{\tiny$\mathit{\expandafter\MakeUppercase\expandafter{#1}}$}}
%  {\mbox{\tiny$\mathit{\expandafter\MakeUppercase\expandafter{#1}}$}}
%}
\newcommand{\rvar}[1]{\mathsf{#1}}
%\newcommand{\rvar}[1]{\mathrm{#1}}
\newcommand{\rvct}[1]{\boldsymbol{\rvar{#1}}}
\newcommand{\nrm}[1]{\mathcal{N}\lpa #1 \rpa}
\newcommand{\unif}[1]{\mathcal{U}\lpa #1 \rpa}
\newcommand{\rng}[2]{\lbr #1 \dots #2 \rbr}
\newcommand{\expc}[1]{\vvmathbb{E}\lsb #1 \rsb}
\newcommand{\var}[1]{\vvmathbb{V}\lsb #1 \rsb}
\newcommand{\cov}[1]{\vvmathbb{C}\lsb #1 \rsb}
\newcommand{\dr}{\mathrm{d}}
\newcommand{\td}[2]{\frac{\dr #1}{\dr #2}}
\newcommand{\tdd}[2]{\frac{\dr^2 #1}{\dr #2^2}}
\newcommand{\pd}[2]{\frac{\partial #1}{\partial #2}}
\newcommand{\pdd}[3]{\frac{\partial^2 #1}{\partial #2 \partial #3}}
\newcommand{\tr}{^{\mkern-1.5mu\mathsf{T}}}
\newcommand{\sml}[1]{#1}
\newcommand{\obs}[1]{\breve{#1}}
\newcommand{\hamiltonian}{h}
\newcommand{\extended}[1]{\skew{2}{\tilde}{#1}}
\newcommand{\normconst}{Z}
\newcommand{\partfunc}{z}
\newcommand{\trans}{\mathsf{t}}
\newcommand{\transop}{\mathsf{T}}
\newcommand{\hatf}{\skew{2}{\hat}{\rvar{f}}}
\newcommand{\tgtdens}{p}
\newcommand{\tgtprob}{P}
\newcommand{\utgtdens}{\tilde{p}}


\newcommand{\rharp}[1]{\mathpalette\rharpoonvec{#1}}
\newcommand{\rharpvecsign}{\scriptscriptstyle\rightharpoonup}
\newcommand{\rharpoonvec}[2]{%
  \ifx\displaystyle#1\doalign{$\rharpvecsign$}{#1#2}\fi
  \ifx\textstyle#1\doalign{$\rharpvecsign$}{#1#2}\fi
  \ifx\scriptstyle#1\doalign{\scalebox{.6}[.9]{$\rharpvecsign$}}{#1#2}\fi
  \ifx\scriptscriptstyle#1\doalign{\scalebox{.5}[.8]{$\rharpvecsign$}}{#1#2}\fi
}
\newcommand{\lharp}[1]{\mathpalette\lharpoonvec{#1}}
\newcommand{\lharpvecsign}{\scriptscriptstyle\leftharpoonup}
\newcommand{\lharpoonvec}[2]{%
  \ifx\displaystyle#1\doalign{$\lharpvecsign$}{#1#2}\fi
  \ifx\textstyle#1\doalign{$\lharpvecsign$}{#1#2}\fi
  \ifx\scriptstyle#1\doalign{\scalebox{.6}[.9]{$\lharpvecsign$}}{#1#2}\fi
  \ifx\scriptscriptstyle#1\doalign{\scalebox{.5}[.8]{$\lharpvecsign$}}{#1#2}\fi
}
\newcommand{\doalign}[2]{%
 {\vbox{\offinterlineskip\ialign{\hfil##\hfil\cr#1\cr$#2$\cr}}}%
}

\newcommand{\fwdtrans}{\rharp{\trans}}
\newcommand{\bwdtrans}{\lharp{\trans}}
\newcommand{\fwdtransop}{\rharp{\transop}}
\newcommand{\bwdtransop}{\lharp{\transop}}

\newcommand{\func}[1]{\mathrm{#1}}
\newcommand{\vctfunc}[1]{{\mathbf{#1}}}

\newcommand{\inlinetr}{\phantom{}^\textsc{t}}

\makeatletter % Define relationships between lower and upper case Greek characters
  \g@addto@macro\@uclclist{%
    \eth\Eth
    \thorn\Thorn
    \alpha\Alpha
    \beta\Beta
    \gamma\Gamma
    \delta\Delta
    \epsilon\Epsilon
    \varepsilon\Varepsilon
    \zeta\Zeta
    \eta\Eta
    \theta\Theta
    \vartheta\Vartheta
    \iota\Iota
    \kappa\Kappa
    \lambda\Lambda
    \mu\Mu
    \nu\Nu
    \xi\Xi
    \omicron\Omicron
    \pi\Pi
    \varpi\Varpi
    \rho\Rho
    \varrho\Varrho
    \sigma\Sigma
    \varsigma\Varsigma
    \tau\Tau
    \upsilon\Upsilon
    \phi\Phi
    \varphi\Varphi
    \chi\Chi
    \psi\Psi
    \omega\Omega
  }

\usepackage{scalerel}
\newsavebox{\foobox}
\newcommand{\slantbox}[2][0]{\colorlet{slantcolor}{.}\mbox{%
        \sbox{\foobox}{\color{slantcolor}#2}%
        \hskip\wd\foobox
        \pdfsave
        \pdfsetmatrix{1 0 #1 1}%
        \llap{\usebox{\foobox}}%
        \pdfrestore
}}
\newcommand\unslant[2][-.2]{%
  \mkern1mu%
  \ThisStyle{\slantbox[#1]{$\SavedStyle#2$}}%
  \mkern-1mu%
}

%\DeclareSymbolFont{sfletters}{U}{eur}{m}{n}
%\SetSymbolFont{sfletters}{sans}{U}{eur}{m}{n}

\DeclareSymbolFont{sfletters}{OML}{cmssm}{m}{it}

\DeclareMathSymbol{\sfalpha}{\mathord}{sfletters}{"0B}
\DeclareMathSymbol{\sfbeta}{\mathord}{sfletters}{"0C}
\DeclareMathSymbol{\sfgamma}{\mathord}{sfletters}{"0D}
\DeclareMathSymbol{\sfdelta}{\mathord}{sfletters}{"0E}
\DeclareMathSymbol{\sfepsilon}{\mathord}{sfletters}{"0F}
\DeclareMathSymbol{\sfzeta}{\mathord}{sfletters}{"10}
\DeclareMathSymbol{\sfeta}{\mathord}{sfletters}{"11}
\DeclareMathSymbol{\sftheta}{\mathord}{sfletters}{"12}
\DeclareMathSymbol{\sfiota}{\mathord}{sfletters}{"13}
\DeclareMathSymbol{\sfkappa}{\mathord}{sfletters}{"14}
\DeclareMathSymbol{\sflambda}{\mathord}{sfletters}{"15}
\DeclareMathSymbol{\sfmu}{\mathord}{sfletters}{"16}
\DeclareMathSymbol{\sfnu}{\mathord}{sfletters}{"17}
\DeclareMathSymbol{\sfxi}{\mathord}{sfletters}{"18}
\DeclareMathSymbol{\sfpi}{\mathord}{sfletters}{"19}
\DeclareMathSymbol{\sfrho}{\mathord}{sfletters}{"1A}
\DeclareMathSymbol{\sfsigma}{\mathord}{sfletters}{"1B}
\DeclareMathSymbol{\sftau}{\mathord}{sfletters}{"1C}
\DeclareMathSymbol{\sfupsilon}{\mathord}{sfletters}{"1D}
\DeclareMathSymbol{\sfphi}{\mathord}{sfletters}{"1E}
\DeclareMathSymbol{\sfchi}{\mathord}{sfletters}{"1F}
\DeclareMathSymbol{\sfpsi}{\mathord}{sfletters}{"20}
\DeclareMathSymbol{\sfomega}{\mathord}{sfletters}{"21}
\DeclareMathSymbol{\sfvarepsilon}{\mathord}{sfletters}{"22}
\DeclareMathSymbol{\sfvartheta}{\mathord}{sfletters}{"23}
\DeclareMathSymbol{\sfvarpi}{\mathord}{sfletters}{"24}
\DeclareMathSymbol{\sfvarrho}{\mathord}{sfletters}{"25}
\DeclareMathSymbol{\sfvarsigma}{\mathord}{sfletters}{"26}
\DeclareMathSymbol{\sfvarphi}{\mathord}{sfletters}{"27}

\newcommand{\upsfalpha}{\unslant\sfalpha}
\newcommand{\upsfbeta}{\unslant\sfbeta}
\newcommand{\upsfgamma}{\unslant\sfgamma}
\newcommand{\upsfdelta}{\unslant\sfdelta}
\newcommand{\upsfepsilon}{\unslant\sfepsilon}
\newcommand{\upsfzeta}{\unslant\sfzeta}
\newcommand{\upsfeta}{\unslant\sfeta}
\newcommand{\upsftheta}{\unslant\sftheta}
\newcommand{\upsfiota}{\unslant\sfiota}
\newcommand{\upsfkappa}{\unslant\sfkappa}
\newcommand{\upsflambda}{\unslant\sflambda}
\newcommand{\upsfmu}{\unslant\sfmu}
\newcommand{\upsfnu}{\unslant\sfnu}
\newcommand{\upsfxi}{\unslant\sfxi}
\newcommand{\upsfpi}{\unslant\sfpi}
\newcommand{\upsfrho}{\unslant\sfrho}
\newcommand{\upsfsigma}{\unslant\sfsigma}
\newcommand{\upsftau}{\unslant\sftau}
\newcommand{\upsfupsilon}{\unslant\sfupsilon}
\newcommand{\upsfphi}{\unslant\sfphi}
\newcommand{\upsfchi}{\unslant\sfchi}
\newcommand{\upsfpsi}{\unslant\sfpsi}
\newcommand{\upsfomega}{\unslant\sfomega}
\newcommand{\upsfvarepsilon}{\unslant\sfvarepsilon}
\newcommand{\upsfvartheta}{\unslant\sfvartheta}
\newcommand{\upsfvarpi}{\unslant\sfvarpi}
\newcommand{\upsfvarrho}{\unslant\sfvarrho}
\newcommand{\upsfvarsigma}{\unslant\sfvarsigma}
\newcommand{\upsfvarphi}{\unslant\sfvarphi}
